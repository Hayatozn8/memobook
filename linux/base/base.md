<span id="catalog"></span>

- [简介](#简介)
- [启动linux](#启动linux)
- [linux目录结构](#linux目录结构)
- [vim编辑器](#vim编辑器)
- [网络连接](#网络连接)
- [用户管理](#用户管理)
- [实用指令](#实用指令)
    - [指定运行级别](#指定运行级别)
    - [帮助指令](#帮助指令)
    - [文件目录操作](#文件目录操作)
    - [时间日期类指令](#时间日期类指令)
    - [搜索查找指令](#搜索查找指令)
    - [压缩解压缩指令](#压缩解压缩指令)
- [组管理](#组管理)
- [文件权限管理](#文件权限管理)
- [定时任务调度](#定时任务调度)
- [硬盘管理](#硬盘管理)
    - [磁盘分区和挂载](#磁盘分区和挂载)
    - [磁盘情况查询](#磁盘情况查询)
- [进程与服务管理](#进程与服务管理)
    - [进程管理](#进程管理)
    - [服务管理](#服务管理)
    - [进程监控](#进程监控)
- [包管理](#包管理)
    - [RPM包管理](#rpm包管理)
    - [yum包管理](#yum包管理)
- [shell](#shell)
    - [shell基本知识](#shell基本知识)
    - [shell变量](#shell变量)
    - [shell运算符](#shell运算符)
    - [shell判断语句](#shell判断语句)
    - [shell流程控制](#shell流程控制)
    - [shell函数](#shell函数)
- [其他](#其他)

# 简介
[top](#catalog)
- Linux的主要发行版--在Linux内核上添加了其他的应用软件
    - Redhat
        - CentOS
        - Redhat
    - Ubuntu
    - Suse
    - 红旗Linux

# 启动linux
[top](#catalog)
- 开机、重启
    - shutdown
        - shutdown -h now： 立刻关机
        - shutdown -h 1：1分钟后关机
        - shutdown -r now：立即重启
    - halt：直接使用，效果等价于关机
    - reboot：重启系统
    - sync：把内存的数据同步到磁盘，关机/重启前执行来防止数据的丢失

# linux目录结构
[top](#catalog)
- 在linux中一切都是文件，以文件的形式管理设备
- 整体是一个树状目录结构
- 只有一个根目录:`/`
- 各个目录的内容是规划好的，不能乱放
- 具体目录结构
    - /bin(/usr/bin、/usr/local/bin)
        - Binary，存放经常使用的命令
    - /sbin(/usr/sbin、/usr/local/sbin)
        - super user，存放系统管理员使用的系统管理程序
    - /home
        - 存放普通用户的主目录，在linux中每个用户都有自己的目录，一般十一用户的账号命名的
        - 例如使用useradd xxx 后，会在该目录下生成一个文件名为xxx的目录；使用userdel -r xxx后，会将该目录删除
    - /root
        - 系统管理员/超级权限用户的主目录
    - lib
        - 系统开机所需要的最基本的动态连接共享库，其作用类似与Windows里的DLL文件，机会所有的应用程序都需要用到这些共享库
    - /lost+found
        - 该目录一般都是空的，当系统非法关机后，会存放一些文件
    - /etc
        - 所有系统管理所需要的配置文件和子目录，**包括环境变量配置和一些软件的配置**
    - /usr
        - 一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似与windows下的program files目录
    - /boot
        - 存放启动linux时使用的一些核心文件，**包括一些连接文件以及镜像文件**
    - /proc （尽量不要动）
        - 一个虚拟目录，是系统内存的映射，可以访问这个目录来获取信息
    - /srv （尽量不要动）
        - service，该目录存放一些服务启动之后需要提取的数据
    - /sys （尽量不要动）
        - linux2.6内核的一个很大的变化。该目录下安装了2.6内核中新出现的一个文件系统
    - /tmp
        - 存放临时文件
    - /dev
        - 类似于windows的设备管理器，把所有的硬件用文件的形式存储
    - /media
        - linxu系统会自动识别一些设备，例如U盘、光驱等等。识别之后，linux会将这些设备挂载到这个目录下
    - /mnt
        - 让用户可以使用该目录来**临时挂在别的文件系统**。例如，可以将外部存储挂载到/mnt/上
    - /opt
        - 一般用来存放软件安装包，默认为空
    - /usr/local
        - 执行软件安装之后，软件的安装目录。**一般是通过编译源码的方式安装的程序**
    - /var
        - 这个目录中存放着在不断扩充的东西，习惯将经常被修改的目录放在这个目录下，**包括各种日志文件**
    - /selinux（security-enhanced linux）
        - 一种安全子系统，能控制程序只访问特定文件

# vim编辑器
[top](#catalog)
- 所有的linux系统都会内建vi编辑器
- vim具有程序编辑的能力，可以看作是vi的增强版
- 三种常见模式
    - 正常模式：
        - 打开文件后直接进入正常模式
        - 在该模式下可以使用：上下左右 来移动光标；可以使用：删除字符/删除整行 来处理文件内容；可以使用：复制、粘贴 来处理数据
    - 插入模式(编辑模式)：
        - 在该模式下可以输入数据
        - 按下：i  、I、o、O、a、A、r、R等任何一个字母后会静如编辑模式
    - 命令行模式：
        - 可以完成读取、存盘、替换、离开vim、显示行号等操作
        - 指令
            - :q 退出
            - :wq 保存退出
            - :q! 强制退出(放弃修改)
- 正常模式快捷键快捷键
    - yy：拷贝当前行(整行)，nyy：从光标行开始拷贝n行，p粘贴(如果粘贴的时候光标在行中间，则粘贴的时候会从下一行粘贴)
    - dd：删除当前行，ndd：从光标行开始删除n行
    - gg：回到文档首行，GG回到文档末行
    - u：撤销操作
    - n，shift+g：将光标移动到第n行
- 命令行模式快捷键
    - :/关键字，在当前文档中进行检索，检索后按`n`来移动到下一个检索结果
    - :set nu 设置行号，:set nonu 取消行号

# 网络连接
[top](#catalog)
- 虚拟机网络链接的三种形式
    - 桥链接
        - 使用桥接的场景：
            - 假设网段中有两个人 A：192.168.0.10和B：192.168.20
            - 如果A在自己的机器上创建 虚拟机X：192.168.0.30，在桥连接的方式中，虚拟机会共享网段中的IP地址
            - 在同一个网段中B可以直接访问到A的虚拟机X
            - 每个人都可以在自己的机器上创建虚拟机来共享信息
            - 每个网段共有255个IP，可使用的是253个，**如果每个人都创建虚拟机会导致IP冲突**
        - 优点：可以方便的和其他系统进行进行通信
        - 缺点：会造成IP冲突 
    - NAT模式--网络地址转换方式
        - 虚拟机的IP不在网段中，可以访问外网，不会造成IP冲突
        - 其他用户无法访问自己机器上的虚拟机
    - 主机模式：虚拟机是一个独立的主机，不能访问外网

- 网络配置
    - 虚拟linux和window系统 通过**vmnet8虚拟网卡**构成了一个网络
    - vmnet8虚拟网卡
    - 查看网络IP和网关
        - 方式1
            - vm的虚拟网络编辑器
                - 查看方法：vm编辑-->虚拟网络编辑器
            - vmnet8虚拟网卡的IP可以在**子网IP**中进行设置
            - vm的网关
                - 查看方法：vm编辑-->虚拟网络编辑器-->VMnet8-->NAT设置 
        - 方式2
            - 在windows中使用ipconfig查看
        - 方式3
            - 控制面板-->网络和Internet-->网络连接-->Vmnet8/右键-->属性
            - IPv4 -->属性
    - linux的IP设置
        - 自动获取
            - 自动获取的IP每次都不一样，不适用于做服务器
        - 指定IP
            - 网卡配置文件：`/etc/sysconfig/network-scripts/ifcfg-ethXXX`
            - 修改的方法
                - BOOTPROTO=static #固定IP
                - ONBOOT=yes #启用BOOT
                - IPADDR=指定IP地址
                - GATEWAY=指定VMnet8的网关
                - DNS1=和VMnet8的网关一样即可
            - 修改后需要重启网络服务或者重启系统：
                - `service network restart`

# 用户管理
[top](#catalog)
- 用户登录注销
    - 尽量不使用root账号登录，因为权限过大，容易出现误操作。应该利用普通用户登录，登录后在用`su - 用户名`来切换成root用户
    - logout 注销用户 
        - **该指令在图形界面无效，在运行级别3下有效**
- 用户管理
    - 基本概念--管理规则
        - 用户家目录：`/home/`目录下有各自的用户家目录，当用户登录是，会自动的进入到自己的家目录
        - linux是一个多用户多任务的操作系统，任何一个要使用系统资源的用户，都必须向系统管理员申请一个账号
        - linux的用户必须至少属于一个组
    - 添加用户
        - useradd [选项] 用户名
            - 直接使用：`useradd 用户名A`，并且没有指定用户组的时候，会默认创建一个名为:`用户名A`的组，并将`用户A名`放到`用户A名`这个组中
            - `useradd -d 指定目录 用户名`：创建新的用户，同时将用户家目录设定为指定目录
                - 这种创建方式，指定目录和用户名不一定相同
                - 使用该指令时，最好使用不存在的指定目录，避免异常
            - `useradd -g 用户组 用户名`添加用户时指定用户组
        - `passwd 用户名` 给用户指定或修改密码
    - 删除用户
        - `userdel 用户名` : 删除用户，但保留家目录
        - `uesrdel -r 用户名` 删除用户，同时删除家目录
        - 删除用户时应该尽量保留家目录
    - 查询用户信息
        - `id 用户名`
            - 结果会显示：用户id，组id，组名
            - 如果指定用户名不存在，会在控制台上显示该用户不存在
    - 切换用户
        - `su - 用户名` 通过该指令切换到高权限用户
            - 从高权限用户切换到低权限用户时，不需要输入密码。反之则必须输入
            - `exit` 通过该指令来还原到原来的用户
    - whoami 查看当前用户 
    - 用户组
        - 类似于角色，系统可以对有共性的多个用户进行统一的管理
        - 组操作
            - `groupadd 组名` 创建一个组
            - `groupdel 组名` 删除一个组
            - `useradd -g 用户组 用户名`添加用户时指定用户组
                - 先创建组，再创建用户
            - `usermod -g 用户组 用户名` 修改用户组
    - 用户配置文件
        - 记录了用户发的各种信息
        - 保存文件：`/etc/passwd`
        - 每行的内容
            - `用户名:口令:用户ID:组ID:注释性描述(可能为空):用户家目录:该用户对应的shell解释器`
    - 组配置文件
        - 保存文件：`/etc/group`
        - 每行的内容
            - `组名:口令:组标识号:组内用户列表`
    - 口令配置文件
        - 保存密码和登录信息，加密信息
        - 保存文件：`/etc/shadow`
        - 每行的内容
            - `登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志`

# 实用指令
## 指定运行级别
[top](#catalog)
- 运行级别说明
    - 0:关机
    - 1:单用户，不需要密码就可以登录，可以用来找回密码
        - 只能直接在机器上操作，无法远程操作
    - 2:多用户无网络
    - 3:多用户有网络，常用
    - 4:保留，系统未使用
    - 5:图形界面
    - 6:重启
- 常用运行级别是**3和5**
- 系统的运行级别配置文件：`/etc/inittab`
    - 修改默认的运行级别可修改配置文件内容：`id:5:initdefault:` 中的数字 
    - 如果被恶意修改为0级别--即启动后又关机，则可以通过1单用户模式来修改级别
- 切换到指定运行级别的指令：`init [012356]`
    - `init 3`与`init 5` 可以在图形界面和控制台之间进行切换
    - `init 0` 直接关机
 
## 帮助指令
[top](#catalog)
- `man 指令`
- `help 指令`

## 文件目录操作
[top](#catalog)
- pwd
    - 显示当前工作目录的绝对路径
- ls [选项] [目录或文件]
    - 选项：
        - -a 显示当前所有的文件和目录，包括隐藏的
        - -l 以列表的方式显示
- cd [参数/绝路路径/相对路径]
    - `cd ~`,`cd` 回到家目录
    - 相对路径从工作目录开始
    - `.` 当前目录
    - `..` 上级目录
- mkdir [选项] 需要创建的目录
    - 创建目录
    - 常用选项
        - -p 递归创建目录
- rmdir [选项] 需要删除的空目录
    - 删除空目录，如果目录下有内容无法删除
    - 删除非空目录可以使用：`rm -rf`
- touch 文件名1 文件名2 。。。。。 文件名n
    - 创建空文件，可以同时创建一个或多个空文件
- cp [选项] source dest
    - 拷贝source到dest目录，可以拷贝文件夹或文件
    - 常用选项
        - -r 递归复制文件夹
    - `\cp` 强制拷贝，在这种拷贝方式下，如果文件已存在，不会询问是否覆盖文件，直接覆盖
- rm [选项] 需要删除的文件或目录
    - 删除文件或目录
    - 常用选项
        - -r 递归删除整个文件夹
        - -f 强制删除不提示
- mv 
    - `mv oldname newname` 文件重命名
        - 如果newname文件存在，将会覆盖该文件
    - `mv temp/movefile /targetFolder` 移动文件
- cat [选项] 需要查看的文件
    - 以只读方式查看文件内容  
    - 常用选项
        - -n 显示行号
- more 需要查看的文件
    - more是一个基于vi编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容
    - 常用方式：`cat 文件名 | more`
    - 快捷键

        |操作|功能说明|
        |-|-|
        |空白键 (space)|代表向下翻一页|
        |Enter|代表向下翻**一行**|
        |q|代表立刻离开 more ，不再显示该文件内容|
        |Ctrl+F|向下滚动一屏|
        |Ctrl+B|返回上一屏|
        |=|输出当前行的行号|
        |:f|输出文件名和当前行的行号|
- less 需要查看的文件
    - 用来分屏查看文件内容，功能与more类似，支持各种显示终端
    - less在显示文件内容时，并不是一次将整个文件加载之后再显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率
    - 快捷键

    |操作|功能说明|
    |-|-|
    |enter|向下移动一行|
    |空白键|向下翻动一页|
    |[pagedown]|向下翻动一页|
    |[pageup]|向上翻动一页|
    |/字串|向下搜寻『字串』的功能;n:向下查找;N:向上查找;|
    |?字串|向上搜寻『字串』的功能;n:向上查找;N:向下查找;|
    |q|离开 less 这个程序|
- `>` 输出重定向
    - 进行覆盖写
- `>>` 追加
    - 进行追加写
- echo [选项] [输出内容]
    - 输出控制内容到控制台
    - 可以用来输出环境变量
    - `echo "sfsfsf"` 或 `echo 'sfsfsf'` 输出时会忽略引号
- head
    - 显示文件的开头部分内容，默认显示文件的前10行
    - `head -n 行数 文件名` 查看前n行内通
- tail
    - 输出文件的尾部内容，默认显示文件的后10行内容 
    - `tail 文件名` 查看文件后10行内容
    - `tail -n 行数 文件名` 查看文件后n行的内容
    - `tail -f 文件名` 实时追踪该文件的所有更新，并显示到屏幕上
- ln
    - 创建软链接，类似于快捷方式
    - `ln -s [原文件或目录][软链接名]`
    - cd进入软链接时，路径会停留在软链接名下，但是该文件下的内容还是软链接执行的目录内容
    - `rm [-rf] 软链接名` 删除软链接
        - 软链接后不能在加`/`，加了`/`后相当于去删除链接目录下的内容，这是不允许的
- history
    - 默认显示所有执行过的历史命令
    - `history n` 显示最近使用的n个指令 
- `!n` 执行history中的编号为n的指令

## 时间日期类指令
[top](#catalog)
- date
    - `date` 显示当前时间
    - `date "+%Y-%m-%d %H:%M:%S"` 按指定的格式显示日期，%Y前面必须使用`+`，日期中的分割符可以随意指定，%Y、%m、%d、%H、%M、%S不能变化
    - `date -s "字符串时间"` 设置系统时间
        - 字符串时间：xxxx-xx-xx xx:xx:xx
    - `date +%s`，显示秒数
    - `date -d "09 Oct 2024 04:037:35"`，将日期字符串转为日期
- cal
    - 查看日历
    - 默认显示当前月的日历
    - `cal yyyy` 显示某一年的日历

## 搜索查找指令
[top](#catalog)
- find [搜索范围] [选项]
    - 从指定目录向下递归遍历各个子目录，将满足条件的文件或者目录显示在终端
    - 选项说明
        - `-name 查找的文件名` 按照指定的文件名查找文件
        - `-user 用户名` 查找属于指定用户的文件
        - `-size 文件大小` 按照文件大小来查找文件
            - `-size +20k` 查找大于20k的文件
            - `-size -20k` 查找小于20k的文件
            - `-size 20k` 查找等于20k的文件
- locate 文件名
    - 快速定位文件路径。locate指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位。
        - locate无需遍历整个文件系统，速度快
        - 为了保证查询准确度，管理员必须定期更新locate时刻
    - `updatedb` 第一次运行前必须使用该指令来创建locate数据库
- grep [选项] 查找文件内容/源文件
    - 选项
        - -n 显示匹配及行号
        - -i 忽略字母大小写

## 压缩解压缩指令
[top](#catalog)
- gizp/gunzip
    - **用于压缩文件**
    - gizp压缩，gunzip解压缩
    - `gizp 文件名` 将文件压缩为`*.gz`文件
        - 压缩后文件，不保留源文件
    - `gunizp 文件名.gz` 解压缩文件
- zip/unzip
    - **用于压缩文件**
    - zip压缩，unzip解压缩
    - zip [选项] XXX.zip 压缩内容
        - 压缩内容可以压缩文件和命令
        - 选项
            - -r 递归压缩，即压缩目录
    - unzip [选项] XXX.zip
        - 选项
            - `-d 指定解压后的存放目录` 将文件解压到指定目录
- tar [选项] XXX.tar.gz 打包的内容(可以包含多个)
    - **用于打包**，生成*.tar.gz文件
    - 选项说明
        - -c 产生.tar打包文件
        - -v 执行时显示详细信息
        - -f 指定压缩后的文件名
        - -z 打包同时压缩
        - -x 解压缩.tar文件
    - 常用选项组合
        - -zcvf 压缩文件为指定文件名， 同时输出压缩信息
            - 可以压缩多个文件，也可以直接压缩目录
        - -zxvf 解压缩文件
            - `-zxvf *.tar.gz` 直接解压到当前目录
            - `-zxvf *.tar.gz -C 指定目录` 直接解压到指定目录，如果指定目录不存在会报错

# 组管理
[top](#catalog)
- 每个文件都有：所有者、所在组、其他组
- `chown 用户名 文件名` 修改文件的所有者(change owner)
- `groupadd 组名` 创建组
- `chgrp 组名 文件名` 修改文件的所在组
- `usermod -g 所在组 用户名` 改变用户所在组
- `usermod -d 家目录 用户名` 改变用户的家目录

# 文件权限管理
[top](#catalog)
- 文件信息
    - 文件类型
        - - 普通文件
        - d 目录
        - l 软连接
        - c 字符设备(如键盘鼠标)
        - b 块文件(如硬盘)
    - rwx rwx rwx N
        - 三组分别是：所有者、所在组、其他组的权限
        - N
            - 如果是文件，N表示硬链接的个数
            - 如果是目录，N表示该目录下子目录的个数，也包含`.`和`..`这两个目录
        - rwx：读、写、执行 的权限
            - r=4, w=2, x=1
            - 对于文件：r=可以读取，w=可以修改，x=可执行
            - 对于目录：
                - r=可以读取查看目录内容，可以使用ls查看目录内容
                - w=可以在目录内创建、删除、重命名
                - x=可以cd进入目录
    - 占用的空间
        - 对于文件，是字节数
        - 对于目录，是目录本身占用的空间(很多都是4096)，不是目录下的内容占的空间
            - **可以把目录看成一种特殊的文件**
- chmod 修改文件/目录的权限
    - 角色标识
        - u=所有者
        - g=所在组
        - o=其他组
        - a=u+g+o 所有人
    - 权限变更方式
        - `+、-、=`
            - 分别表示：添加，删除，设定
            - 如：`chmod u=rwx 文件/目录`，`chmod o+w 文件/目录`，`chmod o-w 文件/目录`
        - 通过数字变更
            - 如：`chmod u=rwx g=rx o=rx 文件/目录` ==> `chmod 755 文件/目录`
- chown 修改文件/目录的所有者/所在组
    - `chown 用户名 文件名` 修改目录的所有者
    - `chown 用户名：组名 文件名` 修改目录的所有者和所有组
    - `chown -R 用户名 目录` 递归修改该目录下的所有文件的所有者
- chgrp 修改文件/目录的所在组
    - `chgrp 组名 文件名/目录` 修改文件/目录的所在组
    - `chgrp -R 组名 目录` 递归修改目录下所有文件的所在组

# 定时任务调度
[top](#catalog)
- 任务调度：系统在某个时间执行特定的命令或程序
- 任务调度分类
    - 系统工作：如病毒扫描
    - 个别用户工作：如数据的备份
- crontab [选项]
    - 常用选项
        - -e 编辑crontab定时任务
            - 如果是简单的任务可以直接在crontab添加；如果任务复杂需要脚本
        - -l 查询crontab任务
        - -r 删除当前用户的所有crontab任务
    - 参数说明
        - `分钟 小时 日 月 星期`
            - 分钟 0-59
            - 小时 0-23
            - 天 1-31
            - 月 1-12
            - 星期 0-7 (0、7都表示星期日)
        - 特殊符号
            - `*`代表任何时间
            - `,` 代表不连续的时间
            - `-` 代表连续的时间范围
            - `*/n` 代表每个n个单位执行一次

# 硬盘管理
## 磁盘分区和挂载
[top](#catalog)
- linux只有一个根目录，一个独立且唯一的文件结构
- 一个分区通过挂载与一个目录相关联
- 硬盘说明
    - IDE硬盘
        - 驱动器标识符：`hdx~`
        - x代表盘号：a=基本盘，b=基本从属盘，c=辅助主盘，d=辅助从属盘
        - ～代表分区：1～4表示主分区或扩展分区，从5开始表示逻辑分区
    - SCSI
        - 驱动器标识符：`sdx~`
        - x代表盘号：a=基本盘，b=基本从属盘，c=辅助主盘，d=辅助从属盘
        - ～代表分区：1～4表示主分区或扩展分区，从5开始表示逻辑分区
- `lsblk -f`(老师不离开) 查看分区的挂载情况
    - `lsblk` 直接使用可以查看占用空间大小
- 挂载分区
    - 步骤
        1. 虚拟机添加硬盘(买地)
            - 虚拟机-->设置-->硬件/硬盘-->添加-->添加硬件向导/硬盘-->下一步
            - 虚拟磁盘类型/下一步-->创建新虚拟磁盘/下一步-->磁盘大小/将虚拟磁盘按拆分成多个文件-->自动保存为*.vmdk文件
            - 重启虚拟机，使机器可以识别硬盘
        2. 分区(造房)
            - `fdisk /dev/sdb`
            - command：输入n，添加一个新的分区
            - command：p 主分区，e 扩展分区
            - command：分区的数量：1～4
            - First cylinder 起始扇区：使用默认值1
            - command：输入w，**把分区的信息写入文件并退出**
        3. 格式化(装修)
            - `mkfs -t ext4 /dev/sdb1` 将sdb1格式化成ext4文件系统
        4. 挂载(住人)
            - 创建一个目录
            - `mount /dev/sdb1 指定挂载目录` 临时挂载分区到指定目录
            - 重启后挂载失效
        5. 设置可以自动挂载--永久挂载
            - 重启后挂载不失效
            - 编辑文件`/etc/fstab`，该文件记录的硬盘分区和挂载点的信息
            - `mount -a` 使修改后的挂载配置立即生效
- 卸载分区
    - `umonut /dev/sdb1` 获取 `umonut 挂载点`
    - 卸载之前必须退出该分区所挂载的目录

## 磁盘情况查询
[top](#catalog)
- 查询系统整体磁盘使用情况
    - `df -h`
- 查询指定目录的磁盘占用情况
    - `du [选项] /目录`
        - 选项
            - -s 指定目录占用空间的合计
            - -h 带计量单位
            - -a 含文件
            - --max-depth=1 子目录深度
            - -c 列出明细，同时添加汇总
        - 常用组合
            - -ach 列出文件+单位+汇总
- 磁盘情况
    - 统计文件个数：`ls -l | grep "^-" | wc -l`
    - 统计文件个数，包括目录子文件下的文件：`ls -lR | grep "^-" | wc -l`
    - 统计目录个数：`ls -l | grep "^d" | wc -l`
    - 树状图显示文件目录：tree

# 进程与服务管理
## 进程管理
[top](#catalog)
- 在linux中，每个执行的程序都成为一个进程，每个进程都分配一个ID号
- 每一个进程，都会对应一个父进程；从父进程可以复制多个子进程；如果父进程被终止则子进程也会终止
- 进程的存在方式
    - 前台：即用户当前屏幕上可进行操纵的
    - 后台
- 一般系统的服务都是以后台进程的方式存在，且会**常驻在系统中，直到关机才结束**
- 显示系统执行的进程
    - `ps [选项]` 查看当前系统中，有那些正在执行，以及执行情况
        - 选项
            - -a 显示当前终端的所有进程信息
            - -u 以用户的格式显示进程信息
            - -x 显示后台进程运行的参数
            - -e 显示所有进程
            - -f 全格式？？？
        - **一般aux连用**
        - 查看父进程：`ps -ef`
        - 显示的内容
            - PID=进程识别号
            - %CPU=CPU用量
            - %MEM=内存使用量
            - VSZ=使用的虚拟内存
            - RSS=使用的物理内存
            - TT=终端机号
            - STAT=进程的状态
                - S=睡眠
                - s=表示该进程是会话的先导进程
                - N=表示进程拥有比普通优先级更低的优先级
                - R=正在运行
                - D=短期等待
                - Z=僵死进程
                - T=被跟踪或者被停止
            - START=启动时间
            - TIME=进程占用CPU的总时间
            - COMMAND=进程执行时的命令行
- 终止进程
    - `killall 进程名称` 通过进程名终止进程，支持通配符
    - `kill [选项] 进程号` 通过进程号来终止进程
        - 选项
            - -9 强迫进程立即停止 (对于一些系统进程，可能会忽略kill指令，通过-9来强制停止)
    - 过滤进程：ps -aux|grep xxxx
- 查看进程树
    - `pstree [选项]`
        - 选项
            - -p 显示进程PID
            - -u 显示进程的所属用户
## 服务管理
[top](#catalog)
- 服务是进程，运行在后台
- 服务通常会监听某个端口，等待其他程序的请求，如mysql、sshd、防火墙等，因此又称为**守护进程**
- 查看服务名
    - 通过setup来查看
    - 通过配置文件查看：`/etc/init.d`
- service命令
    - `service 服务名 [start|stop|restart|reload|status]`
    - `systemctl` 在CentOS7.0后不再使用`service`，而是使用该指令，使用方法相同
    - 这两个命令执行后会立刻生效，但是重启后失效
- chkconfig 给每个服务的各个运行级别设置自启动关闭，重启系统后生效
    - `chkconfig --list|grep xxx` 查看服务
    - `chkconfig 服务名 --list` 查看某个服务的状态
    - `chkconfig --level n 服务名 on/off` 给某个服务的某个级别指定是否自启动
    - `chkconfig 服务名 on/off` 在所有运行级别下设定服务的是否自启动

## 进程监控
[top](#catalog)
- 动态监控
    - `top [选项]`
        - 用来显示正在执行的进程，top执行一段时间可以更新正在运行的进程
        - 选项
            - `-d 秒数` 指定top每个几秒更新，默认3秒
            - `-i` 不显示任何闲置或僵死的进程
            - `-p PID` 监控指定的进程ID
        - 交互操作说明
            - P：以CPU使用率排序，默认是此项
            - M：以内存使用率排序
            - N：以PID排序
            - q：退出top
            - u+用户名：监视特定用户
            - k+进程ID：终止指定进程
- 监控网络状态
    - netstat [选项]
        - 常用选项
            - -an 按一定顺序排列输出
            - -p 显示那个进程在调用
            - -anp 查看所有

# 包管理
## RPM包管理
[top](#catalog)
- RedHat Package Manager
- 一种用于互联网下载包的打包及安装工具，包含在linux的分发版中
- 它会生成具有.RPM扩展名的文件。类似与widows的setup.exe
- 查询指令
    - `rpm -qa` 查询已安装的rpm列表
    - `rpm -q 软件包名` 查询软件包是否安装
    - `rpm -qi 软件包名` 查询软件包的信息
    - `rpm -ql 软件包名` 查询软件包中的文件，可以查询包安装到了那个路径
    - `rpm -qf 文件路径名` 查询文件所属的软件包
- 卸载
    - `rpm -e RPM包的名称`
    - `rpm -e [--nodeps] RPM包的名称` 强制删除，会略包之间的依赖关系
- 安装
    - `rpm -ivh RPM包全路径名称`
        - `-i` 安装
        - `-v` 提示
        - `-h` 进度条
## yum包管理
[top](#catalog)
- yum是一个shell前端软件包管理器，基于RPM包管理，能够从指定的服务器下载RPM包并且安装，可以自动处理依赖性关系，一次性安装所有依赖包
- `yum list` 查询yum服务器是否哟u 需要安装的软件
- `yum install xxx` 安装

# shell
## shell基本知识
[top](#catalog)
- 应用程序-->shell程序-->linux内核-->硬件
- shell是一个命令解释器、界面系统级程序，用户通过shell向linux内核发送请求来执行程序
- 用户可以用shell来启动、挂载、停止、编写程序
- shell的格式
    - shell脚本以：`#!/bin/bash` 开头，指定执行器
    - shell脚本必须要有可执行权限
    - shell脚本对文件类型/后缀没有要求，一般以`.sh`为后缀
- shell脚本的执行方式
    - 赋予脚本可执行权限
        - `./XXX.sh` 通过相对路径来执行
        - `/aaa/bbb/XXX.sh` 通过绝对路径来执行
    - 脚本没有可执行权限，直接执行
        - `sh ./XXX.sh` 通过`sh`指令来执行
- shell注释
    - 多行注释： 开头`:<<!`, 结尾`!`
    - 单行注释: `#`

## shell变量
[top](#catalog)
- shell变量
    - 显示当前shell中所有变量的指令：set
    - 变量的分类
        - 系统变量
            - 如：$HOME、$PWD、$SHELL、$USER等
        - 用户自定义变量
            - 使用echo输出自定义变量时，需要在变量前添加`$`
- shell变量的使用
    - 定义变量:`变量名=值`
        - 变量定义的规则
            - 变量名可以由：字母、数字、下划线组成，但是不能以数字开头
            - **等号两侧不能有空格**
            - 变量名称一般习惯为大写
    - 删除变量：`unset 变量名`
    - 声明静态变量：`readonly 变量名`
        - **静态变量不能使用unset**
    - 可以把变量提示为全局环境变量，然后在其他shell中使用
        - 基本语法
            - `export 变量名=变量值` 将shell变量输出为环境变量
            - `source 配置文件` 让修改后的配置信息立即生效(重启或者注销用户也可以生效)
            - `echo $变量名` 查询环境变量
    - 将命令的返回值赋给变量
        - 用反引号将命令括起来，如： AAAA=`ls`
        - 用`$()`将命令括起来，如： `AAAA=$(ls)`
    - 位置参数变量
        - 想要使用命令行中的参数信息是，就可以使用位置参数变量
        - 基本语法
            - `$n`
                - $1 ~ $9 表示第1到9个参数
                - 编号10以上的参数需要用`{}`括起来，如：`${10}`
            - `$*`:代表命令行中的所有参数，`$*`把所有的参数看成一个整体；结果中不包含`$0`
            - `$@`:代表命令行中的所有参数，`$@`会把每个参数区分对待；结果中不包含`$0`
            - `$#`:代表命令行中所有参数的**个数**
    - 预定义变量
        - shell设计者事先定义好的变量，可以在shell中直接使用
        - 基本语法
            - `$$` 当前进程的进程号PID
            - `$!` 后台运行的最后一个进程的进程号PID
            - `$?` 最后一次执行的命令的返回状态
                - 如果`$?`=0， 则上一个命令正确执行
                - 如果$?`!=0(具体是什么值，由命令自己决定)，则上一个命令执行不正确
    - 在shell中以后台的方式运行其他的shell
        - `./xxx.sh &` 在shell中添加该代码，使指定shell在后台执行
        - 由于是后台执行，所以执行后控制台会卡住，按enter或ctrl+c即可退出


## shell运算符
[top](#catalog)
- $((运算式))
- $[运算式]
- expr m + n  **加号两边必须要有空格**
    - expr下的其他运算符： `\*` 乘， `/` 除， `%` 取余
    - 使用时需要用反引号括起来，如：AAA=`expr 2 + 3`

## shell判断语句
[top](#catalog)
- 格式
    ```
    if  [ condition ]
    then
            语句
    fi  
    ```
- if  [ condition ]  condition前后都要有空格
    - 非空返回true，空返回false
- 常用判断条件 : [ a 判断条件 b ]
    - = 字符串比较
    - -lt <
    - -le <=
    - -eq =
    - -gt >
    - -ge >=
    - -ne !=
- 按照文件权限进行判断 : [ 判断条件 路径 ]
    - -r 有读的权限
    - -w 有写的权限
    - -x 有执行的权限
- 按照文件类型进行判断 : [ 判断条件 路径 ]
    - -f 文件存在并且是一个常规的文件 
    - -e 文件存在
    - -d 文件存在并是一个目录

## shell流程控制
[top](#catalog)
- if
    - 语法
        ```
        if [ 条件判断式 ];then
            语句
        fi

        if [ 条件判断式 ]
        then
            语句
        elif [ 条件判断式 ]
        then
            语句
        fi
        ```
- case
    - 语法
        ```
        case $变量名 in
        "值1")
        语句1
        ;;
        "值2")
        语句2
        ;;
        ....
        *)
        如果没有匹配的值，则执行默认程序
        ;;
        esac
        ```
- for
    - 语法1
        ```
        for 变量 in 值1 值2 值3...
        do
            语句
        done

        #实例
        for i in "$@"
        do
            echo "$i"
        done
        ```
    - 语法2
        ```
        for((初始值;循环控制条件;变量变化))
        do
            程序
        done

        #实例
        SUM=0
        for(i=1; i<=100; i++)
        do
            SUM=$[$SUM+$1]
        done
        echo $SUM
        ```
- while
    - 语法
        ```
        while [ 条件判断式 ]
        do
            程序
        done
        ```

## shell函数
[top](#catalog)
- 系统函数(常用)
    - basename [路径] [后缀]
        - 获取最后一个`/`后的内容
        - 如果设定了后缀，则从结果中删除相同的后缀
    - dirname [路径]
        - 获取最后一个`/`前的内容，即路径内容
        
- read读取控制台输入
    - read [选项] [参数]
        - 选项
            - -p 指定读取值时的提示符
            - -t 指定读取值时等待的时间(秒)，如果在指定时间之内没有输入就不等待了
        - 参数

            - 指定要读取的变量名
- 自定义函数
    - 语法
        ```
        [ function ] funname[()]
        {
            语句;
            [return int;]
        }

        #调用
        funcname $参数1 $参数2
        ```

# 其他
[top](#catalog)
- `.`的特殊含义
    - 当前目录
    - 使文件生效，相当于source
    - 隐藏文件
    - 任意一个字符，如grep的正则表达式搜索
- 管道：`|`，表示将前一个命令的结果输出传递给后面的命令
- 如何找回丢失的root密码
    - 方法：进入到单用户模式，再修改密码，默认会以root身份进行登录
    - 通过passwd来修改密码
*******************************
